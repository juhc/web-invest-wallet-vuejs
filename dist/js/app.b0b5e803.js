(function(){"use strict";var e={7424:function(e,t,o){var a=o(9242),s=o(3396);function r(e,t,o,a,r,l){const n=(0,s.up)("RouterView");return(0,s.wg)(),(0,s.j4)(n)}var l={},n=o(89);const i=(0,n.Z)(l,[["render",r]]);var d=i,c=o(2483),u=o(7139);const h=e=>((0,s.dD)("data-v-460a5b68"),e=e(),(0,s.Cn)(),e),p={key:0},_={key:1,class:"fetch-error"},m=h((()=>(0,s._)("div",{class:"server-error"},null,-1))),f=h((()=>(0,s._)("span",null,"Потеряна связь с сервером. Попробуйте перезагрузить страницу.",-1))),g=[m,f],v={key:2},y={class:"general-information"},b={class:"general-totals"},w={class:"totals-text"},S=h((()=>(0,s._)("span",{class:"totals-header"},"Общий доход:",-1))),x={class:"totals-text"},C=h((()=>(0,s._)("span",{class:"totals-header"},"Общая стоимость портфеля:",-1)));function D(e,t,o,r,l,n){const i=(0,s.up)("LoadingAnimation"),d=(0,s.up)("ChartDoughnut"),c=(0,s.up)("Table");return(0,s.wg)(),(0,s.iD)("main",null,[e.isLoadingPage?((0,s.wg)(),(0,s.iD)("div",p,[(0,s.Wm)(i)])):e.isFetchError?((0,s.wg)(),(0,s.iD)("div",_,g)):((0,s.wg)(),(0,s.iD)("div",v,[(0,s._)("div",y,[(0,s.Wm)(d,{data:e.getDataset,topShares:e.getTopPrecent,class:"chart-doughnut"},null,8,["data","topShares"]),(0,s._)("div",b,[(0,s._)("div",w,[S,(0,s.Wm)(a.uT,{mode:"out-in",name:"total"},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.iD)("span",{id:"totalProfit",class:(0,u.C_)(["totals-sum",[this.totalProfit>0?"profit-color":"disprofit-color"]]),key:e.totalProfit},(0,u.zw)(e.commaSeparateNumber(this.totalProfit))+" ₽ ",3))])),_:1})]),(0,s._)("div",x,[C,(0,s.Wm)(a.uT,{mode:"out-in",name:"total"},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.iD)("span",{id:"totalSum",class:"totals-sum",key:e.totalSellSum},(0,u.zw)(e.commaSeparateNumber(this.totalSellSum))+" ₽",1))])),_:1})])])]),(0,s.Wm)(c,{shares:e.sortedShares,class:"table-shares",modelValue:e.selectedSort,"onUpdate:modelValue":t[0]||(t[0]=t=>e.selectedSort=t)},null,8,["shares","modelValue"])]))])}o(7658);const k={class:"table"},V={class:"table_share-name"},P={class:"font-family-roboto-mono"},O={class:"font-family-roboto-mono"},F={class:"font-family-roboto-mono"};function j(e,t,o,a,r,l){return(0,s.wg)(),(0,s.iD)("div",k,[(0,s._)("table",null,[(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("td",null,[(0,s._)("span",{onClick:t[0]||(t[0]=e=>l.changeSort("name")),class:(0,u.C_)(["name"===o.modelValue?"up-sort":"_name"===o.modelValue?"down-sort":""])},"Название",2)]),(0,s._)("td",null,[(0,s._)("span",{onClick:t[1]||(t[1]=e=>l.changeSort("average_buy_price")),class:(0,u.C_)(["average_buy_price"===o.modelValue?"up-sort":"_average_buy_price"===o.modelValue?"down-sort":""])},"Средняя цена покупки, ₽",2)]),(0,s._)("td",null,[(0,s._)("span",{onClick:t[2]||(t[2]=e=>l.changeSort("quantity")),class:(0,u.C_)(["quantity"===o.modelValue?"up-sort":"_quantity"===o.modelValue?"down-sort":""])},"Количество",2)]),(0,s._)("td",null,[(0,s._)("span",{onClick:t[3]||(t[3]=e=>l.changeSort("sell_sum")),class:(0,u.C_)(["sell_sum"===o.modelValue?"up-sort":"_sell_sum"===o.modelValue?"down-sort":""])},"Сумма продажи, ₽",2)]),(0,s._)("td",null,[(0,s._)("span",{onClick:t[4]||(t[4]=e=>l.changeSort("expected_yield")),class:(0,u.C_)(["expected_yield"===o.modelValue?"up-sort":"_expected_yield"===o.modelValue?"down-sort":""])},"Доходность, ₽",2)]),(0,s._)("td",null,[(0,s._)("span",{onClick:t[5]||(t[5]=e=>l.changeSort("percent_yield")),class:(0,u.C_)(["percent_yield"===o.modelValue?"up-sort":"_percent_yield"===o.modelValue?"down-sort":""])},"Доходность, %",2)])])]),(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.shares,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.name},[(0,s._)("td",V,(0,u.zw)(e.name),1),(0,s._)("td",P,(0,u.zw)(e.average_buy_price.toFixed(2)),1),(0,s._)("td",O,(0,u.zw)(e.quantity),1),(0,s._)("td",F,(0,u.zw)(e.sell_sum.toFixed(2)),1),(0,s._)("td",{class:(0,u.C_)(["font-family-roboto-mono",[e.expected_yield>=0?"profit-color":"disprofit-color"]])},(0,u.zw)(e.expected_yield.toFixed(2)),3),(0,s._)("td",{class:(0,u.C_)(["font-family-roboto-mono",[e.percent_yield>=0?"profit-color":"disprofit-color"]])},(0,u.zw)(e.percent_yield.toFixed(2))+"%",3)])))),128))])])])}var T={props:{shares:{type:Array,required:!0},modelValue:{type:String,default:"expected_yield"}},methods:{changeSort(e){this.modelValue===e&&(e="_"+e),this.$emit("update:modelValue",e)}}};const z=(0,n.Z)(T,[["render",j],["__scopeId","data-v-f0173412"]]);var L=z;const W=e=>((0,s.dD)("data-v-c01a72e2"),e=e(),(0,s.Cn)(),e),A=W((()=>(0,s._)("span",{class:"top-shares-header"},"Топ-5 по доходности",-1))),q={class:"top-shares"},Z={class:"shares"},I={class:"share"},B={class:"share-text"},E={class:"percent"};function N(e,t,o,a,r,l){const n=(0,s.up)("Doughnut");return(0,s.wg)(),(0,s.iD)("section",null,[A,(0,s._)("div",q,[(0,s.Wm)(n,{class:"chart-doughnut",data:o.data,options:r.options},null,8,["data","options"]),(0,s._)("div",Z,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.topShares,(e=>((0,s.wg)(),(0,s.iD)("div",I,[(0,s._)("div",{class:"share-color",style:(0,u.j5)({"background-color":e.color})},null,4),(0,s._)("div",B,[(0,s.Uk)((0,u.zw)(e.label)+": ",1),(0,s._)("span",E,(0,u.zw)(e.value)+"%",1)])])))),256))])])])}var $=o(9646),R=o(5866);$.kL.register($.qi,$.u,$.De);var H={components:{Doughnut:R.$I},props:{data:{type:Object},topShares:{type:Object}},data(){return{options:{responsive:!1,maintainAspectRatio:!1,plugins:{legend:{display:!1,position:"bottom"}},borderColor:"#19191d",borderWidth:7,borderRadius:10,hoverBorderWidth:3}}}};const K=(0,n.Z)(H,[["render",N],["__scopeId","data-v-c01a72e2"]]);var M=K,U=(0,s.aZ)({components:{Table:L,ChartDoughnut:M},mounted(){let e=this.fetchShares;e();let t=setTimeout((function o(){e(),t=setTimeout(o,2e4)}),5e3)},data(){return{shares:[],isLoadingShares:!1,isFetchError:!1,isLoadingPage:!0,selectedSort:"",totalProfit:0,totalSellSum:0}},methods:{async fetchShares(){this.isLoadingShares=!0;let e="https://"+window.location.hostname+":5000/api/get-shares";fetch(e).then((e=>e.json())).then((e=>{this.shares=JSON.parse(e)})).catch((e=>{this.isFetchError=!0})).finally((()=>{this.isLoadingShares=!1,this.isLoadingPage&&(this.isLoadingPage=!1)}))},commaSeparateNumber(e){var t=1;e<0&&(t=-1,e=-e);let o=e.toString().includes(".")?e.toString().split(".")[0]:e.toString();while(/(\d+)(\d{3})/.test(o.toString()))o=o.toString().replace(/(\d+)(\d{3})/,"$1 $2");return e.toString().includes(".")&&(o=o+"."+e.toString().split(".")[1]),t<0?"-"+o:o}},watch:{shares(e){this.totalProfit=this.shares.reduce(((e,t)=>e+t.expected_yield),0).toFixed(2),this.totalSellSum=this.shares.reduce(((e,t)=>e+t.sell_sum),0).toFixed(2)}},computed:{getDataset(){let e=this.shares.sort(((e,t)=>t.expected_yield-e.expected_yield)).slice(0,5),t=this.shares.sort(((e,t)=>t.expected_yield-e.expected_yield)).slice(5,this.shares.length),o=e.map((e=>e.name));o.push("Остальные");let a=e.map((e=>e.expected_yield));a.push(t.reduce(((e,t)=>e+t.expected_yield),0));let s={labels:o,datasets:[{backgroundColor:["#41B883","#478A6C","#15784B","#B5F37D","#81AD59","#55961A"],data:a}]};return s},getTopPrecent(){let e=this.getDataset,t=[],o=this.totalProfit/100;for(let a=0;a<e.labels.length;a++)t.push({label:e.labels[a],color:e.datasets[0].backgroundColor[a],value:(e.datasets[0].data[a]/o).toFixed(2)});return t},sortedShares(){if("_"===this.selectedSort[0]){let e=this.selectedSort.slice(1,this.selectedSort.length);return"name"===e?[...this.shares].sort(((t,o)=>o[e]?.localeCompare(t[e]))):[...this.shares].sort(((t,o)=>o[e]-t[e]))}return"name"===this.selectedSort?[...this.shares].sort(((e,t)=>e[this.selectedSort]?.localeCompare(t[this.selectedSort]))):[...this.shares].sort(((e,t)=>e[this.selectedSort]-t[this.selectedSort]))}}});const Y=(0,n.Z)(U,[["render",D],["__scopeId","data-v-460a5b68"]]);var J=Y;const G=[{path:"/",component:J}],Q=(0,c.p7)({routes:G,history:(0,c.PO)()});var X=Q,ee=o(65),te=(0,ee.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}});const oe=e=>((0,s.dD)("data-v-74b3926a"),e=e(),(0,s.Cn)(),e),ae={class:"loader"},se=oe((()=>(0,s._)("div",{class:"circle one"},null,-1))),re=oe((()=>(0,s._)("div",{class:"circle two"},null,-1))),le=oe((()=>(0,s._)("div",{class:"circle three"},null,-1))),ne=[se,re,le];function ie(e,t,o,a,r,l){return(0,s.wg)(),(0,s.iD)("div",ae,ne)}var de={name:"LoadingAnimation"};const ce=(0,n.Z)(de,[["render",ie],["__scopeId","data-v-74b3926a"]]);var ue=ce;let he=(0,a.ri)(d);he.use(te).use(X).component(ue.name,ue).mount("#app")}},t={};function o(a){var s=t[a];if(void 0!==s)return s.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,a,s,r){if(!a){var l=1/0;for(c=0;c<e.length;c++){a=e[c][0],s=e[c][1],r=e[c][2];for(var n=!0,i=0;i<a.length;i++)(!1&r||l>=r)&&Object.keys(o.O).every((function(e){return o.O[e](a[i])}))?a.splice(i--,1):(n=!1,r<l&&(l=r));if(n){e.splice(c--,1);var d=s();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,s,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,r,l=a[0],n=a[1],i=a[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(s in n)o.o(n,s)&&(o.m[s]=n[s]);if(i)var c=i(o)}for(t&&t(a);d<l.length;d++)r=l[d],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(c)},a=self["webpackChunkweb_invest_wallet_vue"]=self["webpackChunkweb_invest_wallet_vue"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[998],(function(){return o(7424)}));a=o.O(a)})();
//# sourceMappingURL=app.b0b5e803.js.map